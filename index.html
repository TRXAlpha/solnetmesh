<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Chris — Independent Inventor</title>
<style>
  /* =========================
     RESET + ROOT
     ========================= */
  *{box-sizing:border-box;margin:0;padding:0}
  :root{
    --bg:#141414;
    --accent:#7afcff;
    --ease:cubic-bezier(.2,.8,.2,1);
    --ease-out:cubic-bezier(.16,1,.3,1);
  }
  
  html,body{height:100%;background:var(--bg);color:#fff;font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,Oxygen,Ubuntu,sans-serif;-webkit-font-smoothing:antialiased;overflow:hidden}
  a{color:inherit;text-decoration:none}
  button{background:none;border:none;color:inherit;font:inherit;cursor:pointer;padding:0}
  
  ::selection{background:rgba(122,252,255,0.2)}
  
  /* hide scrollbars */
  .no-scroll{scrollbar-width:none;-ms-overflow-style:none}
  .no-scroll::-webkit-scrollbar{display:none}

  /* =========================
     CANVAS STARFIELD
     ========================= */
  #stars{position:fixed;inset:0;z-index:0;display:block;pointer-events:none}

  /* =========================
     LOADER
     ========================= */
  #loader{
    position:fixed;inset:0;z-index:9999;background:var(--bg);
    display:flex;align-items:center;justify-content:center;
    transition:opacity 800ms var(--ease);pointer-events:none;
  }
  #loader.hide{opacity:0}
  .load-num{
    font-size:clamp(16px,2vw,20px);letter-spacing:0.05em;
    overflow:hidden;height:1.2em;position:relative;
  }
  .load-num span{
    display:block;will-change:transform;
    transform:translate3d(0,100%,0);
  }

  /* =========================
     NAV
     ========================= */
  nav{
    position:fixed;top:0;left:0;right:0;z-index:100;
    display:flex;justify-content:space-between;align-items:center;
    padding:clamp(20px,3vw,40px) clamp(30px,5vw,60px);
    pointer-events:none;
  }
  nav a{
    pointer-events:auto;font-size:clamp(13px,1.2vw,15px);
    letter-spacing:0.02em;transition:opacity 400ms var(--ease);
    will-change:transform;display:inline-block;position:relative;
  }
  nav a:hover{opacity:0.6}
  nav a.active::after{
    content:'';position:absolute;bottom:-4px;left:0;right:0;
    height:1px;background:var(--accent);
  }
  nav .left{font-weight:600}
  nav .right{display:flex;gap:clamp(20px,3vw,40px)}

  /* =========================
     SCROLL PROGRESS BAR
     ========================= */
  #scrollProgress{
    position:fixed;right:clamp(20px,3vw,40px);
    top:50%;transform:translateY(-50%);
    width:2px;height:clamp(100px,30vh,300px);
    background:rgba(255,255,255,0.08);
    z-index:150;opacity:0;transition:opacity 600ms var(--ease);
    pointer-events:none;
  }
  #scrollProgress.show{opacity:1}
  #scrollProgress .bar{
    width:100%;background:var(--accent);
    height:0%;transition:height 200ms ease-out;
    box-shadow:0 0 10px rgba(122,252,255,0.4);
  }

  /* =========================
     MAIN CONTAINER
     ========================= */
  #app{position:relative;width:100%;height:100vh;overflow:hidden}
  
  /* intro screen */
  #intro{
    position:absolute;inset:0;z-index:20;
    display:flex;align-items:center;justify-content:center;
    transition:opacity 800ms var(--ease),transform 800ms var(--ease);
  }
  #intro.hide{opacity:0;transform:scale(0.96);pointer-events:none}
  
  .intro-content{text-align:center;max-width:90%;padding:0 20px}
  .intro-content h1{
    font-size:clamp(40px,8vw,120px);font-weight:800;
    line-height:0.9;letter-spacing:-0.03em;
    margin-bottom:clamp(16px,2vw,24px);
    will-change:transform,opacity;
  }
  .intro-content p{
    font-size:clamp(15px,1.8vw,20px);
    color:rgba(255,255,255,0.7);letter-spacing:0.01em;
    will-change:opacity;
  }
  .intro-content small{
    display:block;margin-top:clamp(20px,3vw,30px);
    font-size:clamp(12px,1.2vw,14px);
    color:rgba(255,255,255,0.4);
  }

  /* main carousel view */
  #main{
    position:absolute;inset:0;z-index:10;
    display:flex;flex-direction:column;justify-content:center;
    opacity:0;pointer-events:none;
    transition:opacity 1200ms var(--ease);
  }
  #main.show{opacity:1;pointer-events:auto}
  #main.fade-out{opacity:0;transition:opacity 1000ms var(--ease)}

  /* =========================
     CAROUSEL
     ========================= */
  .carousel-container{
    width:100%;height:clamp(360px,55vh,640px);
    position:relative;overflow:visible;
    display:flex;align-items:center;justify-content:center;
  }
  
  .carousel-track{
    display:flex;gap:clamp(30px,4vw,60px);
    will-change:transform;
    transition:transform 1400ms var(--ease);
    padding:0 50vw;
  }

  .slide{
    flex:0 0 clamp(320px,45vw,640px);
    height:clamp(360px,52vh,580px);
    border-radius:clamp(8px,1vw,12px);
    position:relative;overflow:hidden;
    cursor:pointer;
    transition:transform 1000ms var(--ease),opacity 1000ms var(--ease),filter 1000ms var(--ease);
    will-change:transform,opacity;
    background:#0a0a0a;
  }

  .slide:not(.active){
    opacity:0.35;
    filter:brightness(0.6) saturate(0.8);
    transform:scale(0.88);
  }
  
  .slide.active{
    opacity:1;
    filter:brightness(1) saturate(1);
    transform:scale(1);
    box-shadow:0 40px 120px rgba(0,0,0,0.8);
  }

  .slide-bg{
    position:absolute;inset:0;
    background-size:cover;background-position:center;
    transition:transform 1200ms var(--ease-out);
  }
  
  .slide:hover .slide-bg{transform:scale(1.06)}

  .slide-content{
    position:absolute;bottom:0;left:0;right:0;
    padding:clamp(20px,3vw,30px);
    background:linear-gradient(180deg,transparent 0%,rgba(0,0,0,0.8) 100%);
    z-index:2;
  }
  
  .slide-content h3{
    font-size:clamp(16px,2vw,24px);
    font-weight:700;letter-spacing:-0.01em;
    margin-bottom:6px;
  }
  
  .slide-content p{
    font-size:clamp(12px,1.4vw,15px);
    color:rgba(255,255,255,0.75);
    letter-spacing:0.01em;
  }

  /* pagination */
  .pagination{
    display:flex;gap:10px;justify-content:center;
    margin-top:clamp(30px,5vh,50px);
  }
  
  .pag-dot{
    width:8px;height:8px;border-radius:50%;
    background:rgba(255,255,255,0.15);
    cursor:pointer;
    transition:all 600ms var(--ease);
  }
  
  .pag-dot:hover{background:rgba(255,255,255,0.3)}
  .pag-dot.active{
    background:var(--accent);
    box-shadow:0 8px 20px rgba(122,252,255,0.3);
    transform:scale(1.3);
  }

  /* cross/counter (centered at bottom) */
  .project-counter{
    position:absolute;
    bottom:clamp(30px,5vh,60px);
    left:50%;transform:translateX(-50%);
    font-size:clamp(13px,1.4vw,16px);
    letter-spacing:0.05em;
    color:rgba(255,255,255,0.5);
    display:flex;align-items:center;gap:12px;
    pointer-events:none;
  }
  
  .counter-cross{
    width:18px;height:18px;position:relative;
    transition:transform 1000ms var(--ease);
  }
  
  .counter-cross::before,
  .counter-cross::after{
    content:'';position:absolute;background:rgba(255,255,255,0.3);
  }
  .counter-cross::before{
    left:50%;top:0;width:1px;height:100%;transform:translateX(-50%);
  }
  .counter-cross::after{
    top:50%;left:0;height:1px;width:100%;transform:translateY(-50%);
  }

  /* =========================
     DETAIL OVERLAY
     ========================= */
  #detail{
    position:fixed;inset:0;z-index:200;
    background:var(--bg);
    opacity:0;pointer-events:none;
    transition:opacity 1000ms var(--ease);
    overflow:hidden;
  }
  #detail.show{opacity:1;pointer-events:auto}

  .detail-scroll{
    height:100%;overflow-y:auto;overflow-x:hidden;
    -webkit-overflow-scrolling:touch;
    padding:clamp(80px,12vh,120px) clamp(20px,5vw,60px) clamp(60px,8vh,100px);
  }

  .detail-hero{
    width:100%;
    height:clamp(300px,50vh,600px);
    border-radius:clamp(8px,1vw,12px);
    background-size:cover;background-position:center;
    margin-bottom:clamp(40px,6vh,60px);
    box-shadow:0 30px 100px rgba(0,0,0,0.7);
    opacity:0;
    transform:translateY(30px);
    transition:opacity 1200ms var(--ease) 200ms,transform 1200ms var(--ease) 200ms;
  }
  #detail.show .detail-hero{opacity:1;transform:translateY(0)}

  .detail-text{
    max-width:800px;margin:0 auto;
    color:rgba(255,255,255,0.9);
    opacity:0;
    transform:translateY(20px);
    transition:opacity 1200ms var(--ease) 400ms,transform 1200ms var(--ease) 400ms;
  }
  #detail.show .detail-text{opacity:1;transform:translateY(0)}
  
  .detail-text h2{
    font-size:clamp(28px,4vw,48px);
    font-weight:800;letter-spacing:-0.02em;
    margin-bottom:clamp(16px,2vw,24px);
  }
  
  .detail-text p{
    font-size:clamp(15px,1.6vw,18px);
    line-height:1.7;letter-spacing:0.01em;
    margin-bottom:1.2em;
    color:rgba(255,255,255,0.85);
  }
  
  .detail-text ul{
    list-style:none;padding:0;
    margin:clamp(20px,3vh,30px) 0;
  }
  
  .detail-text li{
    padding-left:1.5em;position:relative;
    margin-bottom:0.8em;
    font-size:clamp(14px,1.5vw,17px);
    color:rgba(255,255,255,0.8);
  }
  
  .detail-text li::before{
    content:'—';position:absolute;left:0;
    color:var(--accent);
  }

  .detail-text img{
    width:100%;border-radius:clamp(6px,1vw,10px);
    margin:clamp(20px,3vh,30px) 0;
    box-shadow:0 20px 60px rgba(0,0,0,0.6);
  }

  /* close button */
  .close-btn{
    position:fixed;
    top:clamp(20px,3vw,40px);
    right:clamp(30px,5vw,60px);
    z-index:210;
    font-size:clamp(13px,1.2vw,15px);
    letter-spacing:0.02em;
    padding:clamp(8px,1vw,12px) clamp(16px,2vw,24px);
    border:1px solid rgba(255,255,255,0.1);
    border-radius:6px;
    transition:all 400ms var(--ease);
    background:rgba(255,255,255,0.02);
    opacity:0;
    transform:translateY(-10px);
  }
  #detail.show .close-btn{opacity:1;transform:translateY(0);transition-delay:600ms}
  
  .close-btn:hover{
    background:rgba(255,255,255,0.06);
    border-color:rgba(255,255,255,0.2);
  }

  /* =========================
     ABOUT PAGE
     ========================= */
  #about{
    position:absolute;inset:0;z-index:15;
    opacity:0;pointer-events:none;
    transition:opacity 1200ms var(--ease);
    overflow:hidden;
  }
  #about.show{opacity:1;pointer-events:auto}

  .about-scroll{
    height:100%;overflow-y:auto;overflow-x:hidden;
    -webkit-overflow-scrolling:touch;
    padding:clamp(100px,15vh,180px) clamp(30px,6vw,80px) clamp(80px,10vh,120px);
  }

  .about-content{
    max-width:900px;margin:0 auto;
    opacity:0;transform:translateY(30px);
    transition:opacity 1200ms var(--ease) 300ms,transform 1200ms var(--ease) 300ms;
  }
  #about.show .about-content{opacity:1;transform:translateY(0)}

  .about-content h1{
    font-size:clamp(36px,6vw,72px);
    font-weight:800;letter-spacing:-0.03em;
    margin-bottom:clamp(20px,3vh,40px);
    line-height:1;
  }

  .about-content p{
    font-size:clamp(16px,1.8vw,20px);
    line-height:1.7;letter-spacing:0.01em;
    color:rgba(255,255,255,0.85);
    margin-bottom:1.5em;
  }

  .about-content .highlight{
    color:var(--accent);
    font-weight:600;
  }

  /* =========================
     RESPONSIVE
     ========================= */
  @media (max-width:768px){
    .carousel-track{gap:20px;padding:0 50vw}
    .slide{flex:0 0 80vw}
    #scrollProgress{display:none}
  }
</style>
</head>
<body>

<canvas id="stars"></canvas>

<!-- scroll progress bar -->
<div id="scrollProgress">
  <div class="bar"></div>
</div>

<!-- loader -->
<div id="loader">
  <div class="load-num"><span>0%</span></div>
</div>

<!-- nav -->
<nav>
  <div class="left"><a href="/">Chris</a></div>
  <div class="right">
    <a href="#work" id="workLink">Work</a>
    <a href="#about" id="aboutLink">About</a>
  </div>
</nav>

<!-- app container -->
<div id="app">
  
  <!-- intro -->
  <div id="intro">
    <div class="intro-content">
      <h1>Chris — 15 y.o. inventor</h1>
      <p>I build autonomous systems, hardware hacks and LLM experiments.</p>
      <small>Click anywhere to explore</small>
    </div>
  </div>

  <!-- main carousel -->
  <div id="main">
    <div class="carousel-container">
      <div class="carousel-track" id="track"></div>
    </div>
    
    <div class="pagination" id="pagination"></div>
    
    <div class="project-counter">
      <div class="counter-cross"></div>
      <span id="counter">01 — 08</span>
    </div>
  </div>

  <!-- about page -->
  <div id="about">
    <div class="about-scroll no-scroll" id="aboutScroll">
      <div class="about-content">
        <h1>About Chris</h1>
        <p>I'm a <span class="highlight">15-year-old inventor</span> passionate about building things at the intersection of hardware and AI. My work focuses on creating autonomous systems that respect privacy and push the boundaries of what's possible with edge computing.</p>
        
        <p>From running local LLMs on Raspberry Pi clusters to designing credit-card-sized gaming devices, I explore how technology can be both powerful and personal. I believe the future of computing is distributed, private, and surprisingly small.</p>
        
        <p>When I'm not soldering circuits or training models, you'll find me documenting my experiments, contributing to open-source projects, or thinking about how to make technology more accessible and less invasive.</p>
        
        <p>I'm currently exploring reflective AI architectures, secure OTA update systems for IoT fleets, and novel form factors for everyday computing devices.</p>
      </div>
    </div>
  </div>

  <!-- detail overlay -->
  <div id="detail">
    <button class="close-btn" id="closeBtn">Close</button>
    <div class="detail-scroll no-scroll" id="detailScroll">
      <div class="detail-hero" id="detailHero"></div>
      <div class="detail-text" id="detailText"></div>
    </div>
  </div>

</div>

<script>
// =========================
// DATA
// =========================
const PROJECTS = [
  {
    id: 'ghost',
    title: 'Ghost — local-first assistant',
    desc: 'Pi + ESP + local LLMs & telemetry',
    cover: '',
    long: `
      <h2>Ghost — local-first assistant</h2>
      <p>Ghost is a privacy-first assistant that runs across edge nodes, coordinating sensors and local models to make decisions without sending your data to the cloud.</p>
      <p>The system orchestrates multiple Raspberry Pi devices and ESP32 microcontrollers, each running specialized tasks from voice recognition to sensor fusion, all communicating through a secure mesh network.</p>
      <ul>
        <li>Edge LLM orchestration using quantized models</li>
        <li>OTA-secured microcontroller fleet with rollback capability</li>
        <li>Reflective Engine experiments for self-aware AI</li>
        <li>Zero-cloud architecture with local-only data processing</li>
      </ul>
    `
  },
  {
    id: 'doomcard',
    title: 'DoomCard — ESP32',
    desc: 'Credit-card form factor hardware hack',
    cover: '',
    long: `
      <h2>DoomCard — ESP32</h2>
      <p>DoomCard is a credit-card-sized device that runs a tiny Doom port, acts as a 2FA FIDO-like token, and connects to a home station via pogo pins for flashing and maintenance.</p>
      <p>The challenge was fitting a playable game, security features, and a rechargeable power system into an 85mm × 54mm footprint. The result is a conversation starter that's also genuinely useful.</p>
      <ul>
        <li>Custom PCB design with integrated display and controls</li>
        <li>Dual-purpose: entertainment and security device</li>
        <li>Magnetic dock for easy charging and updates</li>
        <li>Battery life: 4+ hours of gameplay</li>
      </ul>
    `
  },
  {
    id: 'honeypot',
    title: 'ESP Honeypot',
    desc: 'Portable AP + DNS logger',
    cover: '',
    long: `
      <h2>ESP Honeypot</h2>
      <p>A compact honeypot that logs nearby probes and DNS queries to microSD, useful for studying local attack surfaces and understanding network behavior in different environments.</p>
      <p>Built on an ESP32 with custom firmware, it masquerades as various common network devices to attract and log suspicious activity. Perfect for security research and learning about network attacks.</p>
    `
  },
  {
    id: 'neural-weather',
    title: 'Neural Weather Station',
    desc: 'ML-powered local forecasting',
    cover: '',
    long: `
      <h2>Neural Weather Station</h2>
      <p>A hyperlocal weather prediction system that learns patterns specific to my neighborhood using an array of sensors and a lightweight neural network.</p>
      <p>Instead of relying on regional forecasts, this system builds a model of microclimatic conditions, often predicting rain or temperature changes 30-60 minutes before larger services.</p>
    `
  },
  {
    id: 'mesh-chat',
    title: 'LoRa Mesh Network',
    desc: 'Off-grid communication protocol',
    cover: '',
    long: `
      <h2>LoRa Mesh Network</h2>
      <p>A resilient mesh network protocol for LoRa devices that enables text messaging and data sync without internet or cellular infrastructure.</p>
      <p>Designed for festivals, hiking trips, and emergency scenarios where traditional communication breaks down. Messages hop between nodes automatically to reach their destination.</p>
    `
  },
  {
    id: 'code-radio',
    title: 'Code Radio',
    desc: 'Generate music from git commits',
    cover: '',
    long: `
      <h2>Code Radio</h2>
      <p>An experimental project that sonifies code repositories, turning git commits into generative ambient music. Different languages, file changes, and commit patterns produce unique sonic textures.</p>
      <p>Built with Tone.js and a custom algorithm that maps code metrics to musical parameters. It's surprisingly meditative to hear a project's evolution.</p>
    `
  },
  {
    id: 'pcb-art',
    title: 'PCB Badge Collection',
    desc: 'Functional circuit board art',
    cover: '',
    long: `
      <h2>PCB Badge Collection</h2>
      <p>A series of artistic PCB designs that double as conference badges, each with unique LED patterns, interactive elements, and hidden features.</p>
      <p>Combining aesthetic design with functional electronics, these badges are conversation starters and teach others about circuit design in an approachable way.</p>
    `
  },
  {
    id: 'contact',
    title: 'Get in touch',
    desc: "Let's build something together",
    cover: '',
    long: `
      <h2>Get in touch</h2>
      <p>I'm always interested in collaborating on projects involving edge AI, hardware hacking, or privacy-focused tech.</p>
      <p>Email: <a href="mailto:you@example.com" style="color:var(--accent)">you@example.com</a></p>
      <p>GitHub: <a href="https://github.com/" style="color:var(--accent)">github.com/yourhandle</a></p>
      <p>Mastodon: <a href="https://mastodon.social/@you" style="color:var(--accent)">@you@mastodon.social</a></p>
    `
  }
];

// =========================
// STARFIELD
// =========================
(function() {
  const canvas = document.getElementById('stars');
  const ctx = canvas.getContext('2d');
  let w, h, stars = [];

  function resize() {
    w = canvas.width = innerWidth;
    h = canvas.height = innerHeight;
    stars = [];
    const count = Math.floor(Math.max(150, Math.min(400, (w * h) / 4000)));
    for (let i = 0; i < count; i++) {
      stars.push({
        x: Math.random() * w,
        y: Math.random() * h,
        r: Math.random() * 1.2 + 0.3,
        a: Math.random() * 0.6 + 0.2,
        v: (Math.random() * 0.012) + 0.003,
        targetA: Math.random() * 0.8 + 0.2
      });
    }
  }

  function draw() {
    ctx.fillStyle = '#141414';
    ctx.fillRect(0, 0, w, h);

    for (const s of stars) {
      // smooth twinkling
      s.a += s.v;
      if (s.a <= 0.1 || s.a >= s.targetA) {
        s.v *= -1;
        if (Math.random() > 0.98) {
          s.targetA = Math.random() * 0.8 + 0.2;
        }
      }
      
      ctx.beginPath();
      ctx.arc(s.x, s.y, s.r, 0, Math.PI * 2);
      ctx.fillStyle = `rgba(255,255,255,${s.a})`;
      ctx.fill();
    }
    requestAnimationFrame(draw);
  }

  addEventListener('resize', resize);
  resize();
  draw();
})();

// =========================
// APP LOGIC
// =========================
const track = document.getElementById('track');
const pagination = document.getElementById('pagination');
const intro = document.getElementById('intro');
const main = document.getElementById('main');
const about = document.getElementById('about');
const detail = document.getElementById('detail');
const detailHero = document.getElementById('detailHero');
const detailText = document.getElementById('detailText');
const detailScroll = document.getElementById('detailScroll');
const aboutScroll = document.getElementById('aboutScroll');
const closeBtn = document.getElementById('closeBtn');
const loader = document.getElementById('loader');
const counter = document.getElementById('counter');
const workLink = document.getElementById('workLink');
const aboutLink = document.getElementById('aboutLink');
const scrollProgress = document.getElementById('scrollProgress');
const progressBar = scrollProgress.querySelector('.bar');

let currentIndex = 0;
let isAnimating = false;

// Build slides
function buildSlides() {
  track.innerHTML = '';
  pagination.innerHTML = '';

  PROJECTS.forEach((project, i) => {
    // slide
    const slide = document.createElement('div');
    slide.className = 'slide';
    slide.dataset.index = i;

    const bg = document.createElement('div');
    bg.className = 'slide-bg';
    if (project.cover) {
      bg.style.backgroundImage = `url(${project.cover})`;
    } else {
      const hue = 190 + (i * 30) % 140;
      bg.style.backgroundImage = `linear-gradient(135deg, hsl(${hue}, 50%, 12%), hsl(${hue}, 40%, 6%))`;
    }

    const content = document.createElement('div');
    content.className = 'slide-content';
    content.innerHTML = `<h3>${project.title}</h3><p>${project.desc}</p>`;

    slide.appendChild(bg);
    slide.appendChild(content);
    slide.addEventListener('click', () => {
      if (!isAnimating && slide.classList.contains('active')) {
        openDetail(i);
      }
    });
    track.appendChild(slide);

    // pagination dot
    const dot = document.createElement('div');
    dot.className = 'pag-dot';
    dot.dataset.index = i;
    dot.addEventListener('click', () => goTo(i));
    pagination.appendChild(dot);
  });

  updateCarousel(false);
}

// Update carousel position
function updateCarousel(animate = true) {
  if (isAnimating && animate) return;
  
  const slides = Array.from(track.children);
  const dots = Array.from(pagination.children);
  
  slides.forEach((slide, i) => {
    slide.classList.toggle('active', i === currentIndex);
  });
  
  dots.forEach((dot, i) => {
    dot.classList.toggle('active', i === currentIndex);
  });

  // center active slide
  const activeSlide = slides[currentIndex];
  if (activeSlide) {
    const slideRect = activeSlide.getBoundingClientRect();
    const trackRect = track.getBoundingClientRect();
    const offset = slideRect.left - trackRect.left;
    const center = innerWidth / 2 - slideRect.width / 2;
    
    track.style.transition = animate ? 'transform 1400ms var(--ease)' : 'none';
    track.style.transform = `translateX(${center - offset}px)`;
    
    if (animate) {
      isAnimating = true;
      setTimeout(() => { isAnimating = false; }, 1400);
    }
  }

  // update counter
  const num = String(currentIndex + 1).padStart(2, '0');
  const total = String(PROJECTS.length).padStart(2, '0');
  counter.textContent = `${num} — ${total}`;
}

// Navigate
function goTo(index) {
  if (isAnimating) return;
  currentIndex = (index + PROJECTS.length) % PROJECTS.length;
  updateCarousel(true);
}

function next() {
  goTo(currentIndex + 1);
}

function prev() {
  goTo(currentIndex - 1);
}

// Detail view
function openDetail(index) {
  currentIndex = index;
  const project = PROJECTS[index];
  
  // fade out carousel
  main.classList.add('fade-out');
  
  setTimeout(() => {
    if (project.cover) {
      detailHero.style.backgroundImage = `url(${project.cover})`;
    } else {
      const hue = 190 + (index * 30) % 140;
      detailHero.style.backgroundImage = `linear-gradient(135deg, hsl(${hue}, 50%, 12%), hsl(${hue}, 40%, 6%))`;
    }
    
    detailText.innerHTML = project.long;
    detail.classList.add('show');
    scrollProgress.classList.add('show');
    document.body.style.overflow = 'hidden';
    detailScroll.scrollTop = 0;
    progressBar.style.height = '0%';
  }, 400);
}

function closeDetail() {
  detail.classList.remove('show');
  scrollProgress.classList.remove('show');
  
  setTimeout(() => {
    main.classList.remove('fade-out');
    document.body.style.overflow = '';
  }, 400);
}

closeBtn.addEventListener('click', closeDetail);

// Update scroll progress bar
function updateScrollProgress() {
  const scrollTop = detailScroll.scrollTop;
  const scrollHeight = detailScroll.scrollHeight - detailScroll.clientHeight;
  const progress = (scrollTop / scrollHeight) * 100;
  progressBar.style.height = `${progress}%`;
}

detailScroll.addEventListener('scroll', updateScrollProgress);
aboutScroll.addEventListener('scroll', () => {
  const scrollTop = aboutScroll.scrollTop;
  const scrollHeight = aboutScroll.scrollHeight - aboutScroll.clientHeight;
  const progress = (scrollTop / scrollHeight) * 100;
  progressBar.style.height = `${progress}%`;
});

// Navigation
workLink.addEventListener('click', (e) => {
  e.preventDefault();
  about.classList.remove('show');
  scrollProgress.classList.remove('show');
  detail.classList.remove('show');
  
  setTimeout(() => {
    main.classList.remove('fade-out');
    main.classList.add('show');
    workLink.classList.add('active');
    aboutLink.classList.remove('active');
  }, 400);
});

aboutLink.addEventListener('click', (e) => {
  e.preventDefault();
  main.classList.add('fade-out');
  detail.classList.remove('show');
  
  setTimeout(() => {
    about.classList.add('show');
    scrollProgress.classList.add('show');
    aboutScroll.scrollTop = 0;
    progressBar.style.height = '0%';
    aboutLink.classList.add('active');
    workLink.classList.remove('active');
  }, 400);
});

// Keyboard controls (faster response)
let lastKeyTime = 0;
const KEY_THROTTLE = 200;

addEventListener('keydown', (e) => {
  const now = Date.now();
  
  if (detail.classList.contains('show')) {
    if (e.key === 'Escape') closeDetail();
    if ((e.key === 'ArrowRight' || e.key === 'ArrowLeft') && now - lastKeyTime > KEY_THROTTLE) {
      lastKeyTime = now;
      if (e.key === 'ArrowRight') { next(); openDetail(currentIndex); }
      if (e.key === 'ArrowLeft') { prev(); openDetail(currentIndex); }
    }
  } else if (!about.classList.contains('show') && now - lastKeyTime > KEY_THROTTLE) {
    if (e.key === 'ArrowRight' || e.key === 'ArrowLeft') {
      lastKeyTime = now;
      if (e.key === 'ArrowRight') next();
      if (e.key === 'ArrowLeft') prev();
    }
  }
});

// Mouse wheel navigation in carousel
let lastWheelTime = 0;
const WHEEL_THROTTLE = 25;

addEventListener('wheel', (e) => {
  // Only work when carousel is visible
  if (!main.classList.contains('show')) return;
  if (about.classList.contains('show')) return;
  if (detail.classList.contains('show')) return;
  if (isAnimating) return;
  
  const now = Date.now();
  if (now - lastWheelTime < WHEEL_THROTTLE) return;
  
  const deltaY = e.deltaY;
  const deltaX = e.deltaX;
  
  // Check if scroll is significant enough
  if (Math.abs(deltaY) > 10 || Math.abs(deltaX) > 10) {
    lastWheelTime = now;
    
    if (Math.abs(deltaY) > Math.abs(deltaX)) {
      // vertical scroll - scroll down = next, scroll up = prev
      if (deltaY > 0) {
        next();
      } else {
        prev();
      }
    } else {
      // horizontal scroll - scroll right = next, scroll left = prev
      if (deltaX > 0) {
        next();
      } else {
        prev();
      }
    }
  }
}, { passive: true });

// Show scene
function showScene() {
  intro.classList.add('hide');
  setTimeout(() => {
    intro.style.display = 'none';
    main.classList.add('show');
    workLink.classList.add('active');
    buildSlides();
    
    // cinematic fast-forward intro
    let steps = Math.min(14, PROJECTS.length * 2);
    let count = 0;
    const interval = setInterval(() => {
      currentIndex = (currentIndex + 1) % PROJECTS.length;
      updateCarousel(true);
      count++;
      if (count >= steps) {
        clearInterval(interval);
        setTimeout(() => {
          currentIndex = 0;
          updateCarousel(true);
        }, 500);
      }
    }, 100);
  }, 400);
}

// Intro click
intro.addEventListener('click', showScene);

// Prevent carousel jumping on small mouse movements
let lastUpdateTime = 0;
const UPDATE_THROTTLE = 100;

addEventListener('mousemove', () => {
  const now = Date.now();
  if (now - lastUpdateTime > UPDATE_THROTTLE && main.classList.contains('show') && !isAnimating) {
    lastUpdateTime = now;
  }
});

// Init with loader animation
(function init() {
  const loadNum = document.querySelector('.load-num span');
  let progress = 0;
  
  const loadInterval = setInterval(() => {
    progress += Math.random() * 15 + 5;
    if (progress >= 100) {
      progress = 100;
      clearInterval(loadInterval);
      loadNum.textContent = '100%';
      
      setTimeout(() => {
        loader.classList.add('hide');
        setTimeout(() => {
          loader.style.display = 'none';
          
          // animate intro in
          const h1 = intro.querySelector('h1');
          const p = intro.querySelector('p');
          h1.style.opacity = '0';
          h1.style.transform = 'translateY(30px)';
          p.style.opacity = '0';
          
          requestAnimationFrame(() => {
            setTimeout(() => {
              h1.style.transition = 'all 1200ms var(--ease)';
              h1.style.opacity = '1';
              h1.style.transform = 'translateY(0)';
              p.style.transition = 'opacity 1200ms var(--ease)';
              p.style.opacity = '1';
            }, 100);
          });
          
          // auto-advance after 2.5s
          setTimeout(showScene, 2500);
        }, 800);
      }, 300);
    } else {
      loadNum.textContent = Math.floor(progress) + '%';
    }
  }, 120);
  
  // animate loader number in
  requestAnimationFrame(() => {
    setTimeout(() => {
      loadNum.style.transition = 'transform 800ms var(--ease)';
      loadNum.style.transform = 'translate3d(0,0,0)';
    }, 100);
  });
})();

// Resize handler
addEventListener('resize', () => {
  if (main.classList.contains('show')) {
    updateCarousel(false);
  }
});
</script>

</body>
</html>
